<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>
  </head>

  <body>
    <div class="layout" id="app">
      <header class="layout-header">
        <div class="layout-header__container">
          <h1 id="title" class="layout-header__title"></h1>
          <button style="margin-left: 10px" onclick="sendName()">send name</button>
        </div>
      </header>

      <aside class="layout-aside">
        <nav class="layout-aside__container">
          <ul class="layout-aside__menu">
            <li class="layout-aside__menu-item" onclick="changeWebView('5173')">
              web view 5173
            </li>

            <li class="layout-aside__menu-item" onclick="changeWebView('3000')">
              vue port 3000
            </li>
          </ul>
        </nav>
      </aside>

      <main class="layout-main">
        <iframe
          id="webViewIframe"
          class="layout-iframe"
          src="http://localhost:5173/"
          title="app-web-view"
          name="app-web-view"
        ></iframe>
      </main>
    </div>

    <div class="loading"></div>
    <script type="module" src="/src/main.js"></script>

    <script>
      const iframe = document.getElementById('webViewIframe')

      function sendName() {
        const message = JSON.stringify({
          name: 'getName',
          payload: { firstName: 'Mehrdad', lastName: 'Dehghanzadeh' }
        })
        iframe.contentWindow.postMessage(message, '*')
      }

      function changeWebView(port) {
        const src = 'http://localhost:' + port
        iframe.setAttribute('src', src)
      }
    </script>
  </body>
</html>
